{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Router Plan",
  "type": "object",
  "required": [
    "intent",
    "specialist",
    "confidence",
    "risk_level",
    "side_effects",
    "rationale"
  ],
  "properties": {
    "intent": {
      "type": "string",
      "enum": [
        "answer_question",
        "draft_content",
        "run_tooling",
        "manage_project",
        "triage"
      ],
      "description": "Classified intent for downstream routing."
    },
    "specialist": {
      "type": "string",
      "enum": [
        "generalist",
        "research",
        "engineering",
        "product",
        "operations",
        "approval"
      ],
      "description": "Selected specialist pipeline for the request."
    },
    "confidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "description": "Router confidence score between 0 and 1."
    },
    "risk_level": {
      "type": "string",
      "enum": ["low", "medium", "high", "critical"],
      "description": "Risk level associated with the proposed routing."
    },
    "side_effects": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "none",
          "read_only",
          "write_data",
          "external_api",
          "financial",
          "user_visible_change"
        ]
      },
      "description": "Expected side effects if the plan proceeds."
    },
    "rationale": {
      "type": "string",
      "description": "Explanation for the routing decision."
    },
    "approver_required": {
      "type": "boolean",
      "description": "Whether the plan needs human or automated approval before execution."
    },
    "constraints": {
      "type": "array",
      "description": "Policy or safety constraints that must be honored.",
      "items": {
        "type": "string"
      }
    }
  },
  "examples": [
    {
      "intent": "manage_project",
      "specialist": "product",
      "confidence": 0.87,
      "risk_level": "medium",
      "side_effects": ["write_data", "user_visible_change"],
      "rationale": "User asked for a rollout plan and stakeholder notification; product specialist can create the plan and delegate notifications.",
      "approver_required": true,
      "constraints": [
        "Notify stakeholders only after approval",
        "Limit external API calls to staging endpoints"
      ]
    }
  ]
}
